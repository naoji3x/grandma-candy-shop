# 単体テスト仕様 （UTS） 作成の指示テンプレート

- 以下のルールに従って、**単体テスト仕様（UTS）** を 1 ファイル作成してください。出力は **Markdown** とします。
- UTS は「テストコード」ではありません。単体テストで **何を保証するか（保証範囲）** を明文化する文書です。
- UTS は **個別テストケースの大量列挙は禁止**です（ケースは UTD/コードへ）。
- 曖昧表現（例:「十分に」「適切に」「基本的に」）は禁止し、合否判定できる形で記述してください。
- 禁止: テストコード全文、SQL、物理テーブル/物理カラム名、実装クラス/関数名、クリック手順など UI 操作の逐語列挙

## 事前に与えられる情報（入力）

次の情報が与えられている前提で、それに整合するUTSを生成してください（不明な場合は「未確定」として明記してよい）。

- 対象領域（例: 店頭販売、在庫連動、発注点判定など）
- 上位仕様ID（任意）
  - 例: `tsp-...`（テスト方針）、`tpc-...`（観点・条件）、`bac-...`（受入条件）、`br-...`（業務ルール）、`nfr-...`（非機能要件）

## 出力フォーマット（必須）

- 先頭に YAML Frontmatter を付与し、以下の形式で記述してください（`id` / `type` / `title` / `status` は必須、`type` は `test` 固定）：

  ```yaml
  ---
  id: uts-<英小文字とハイフンで構成したID>
  type: test
  title: 単体テスト仕様: <対象>
  status: draft # draft / ready / deprecated
  part_of: []
  based_on: []
  supersedes: []
  ---
  ```

- 本文は次の見出し（日本語）をこの順序で必ず含めてください：
  1. 概要
  2. 対象と境界
  3. 保証範囲（観点）
  4. テスト条件（代表条件）
  5. 合格基準とエビデンス
  6. 対象外 / 除外理由
  7. メモ / 将来課題

## 記述ルール（重要）

### トレースの扱い

- UTS には **トレース表（観点ID↔上位仕様IDの表）を書きません**。
- 追跡は Frontmatter の `based_on` で行います。
  - `based_on` には最低限 `tpc-...` を含め、必要に応じて `bac-...` / `br-...` / `nfr-...` を追加してください。

### 1. 概要

- 1〜3文で「この単体テストで何を保証するか」を書いてください。

### 2. 対象と境界

- 対象単位と、外部依存の切り方（モック/スタブ）を明示してください。
- 外部決済・外部API・DB I/O・時刻などは、原則として単体の境界外とし、結合テスト以降で担保する前提を書いてください。

### 3. 保証範囲（観点）

- 単体テストで保証する観点を **一覧表** で整理してください。
- 推奨カラムは次の通りです：
  - `観点ID` / `観点分類` / `観点名` / `保証内容（何を保証するか）` / `優先度` / `備考（根拠）`
- 観点は「切り口」です。ケースの羅列にしないでください。

### 4. テスト条件（代表条件）

- 観点ごとに、代表的な条件を **状態レベル** で表にしてください。
- 具体的な数値・具体値の大量列挙は禁止です（必要なら“境界値”と書き、詳細は UTD に委ねる）。

### 5. 合格基準とエビデンス

- 判定可能な形（条件・根拠）で、完了条件を定義してください。
- 例: CI のテスト結果、カバレッジレポート、不具合管理票。

### 6. 対象外 / 除外理由

- 単体では担保しない範囲と、その理由（結合/非機能/E2E 等で担保）を明記してください。

### 7. メモ / 将来課題

- 未確定の境界条件、将来追加すべき観点などを箇条書きで記載してください。

## 最終チェック（自己検査）

- 観点が「保証範囲（What）」として書けている（ケース集になっていない）
- 対象と境界（モック/スタブ方針）が明確
- 合格基準が判定可能で、エビデンスが紐づいている
- トレース表を書いていない（`based_on` で追跡している）
- トレース表を書いていない（`based_on` で追跡している）
